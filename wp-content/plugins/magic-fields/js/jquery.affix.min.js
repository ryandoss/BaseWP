/*
  affix plug-in for jQuery, License - MIT, Copyright 2009 Traversal: http://traversal.com.au
*/
(function(C){var D={animate:false,animateOptions:{duration:"normal"},to:"ne",keepInWindow:true,offset:[0,0],inset:[0,0],use:"offset",fixed:true,smartOffscreenInset:true,classGlueFromPrefix:"glue-",classGlueToPrefix:"glue-",layerfix:false,autoEvents:{scroll:true,resize:true}};var A=C.browser.msie&&C.browser.version<7;var B="affix";C.fn.affixPosition=function(){var Z,N={},j={},n=arguments;if(n.length>=1){if(typeof (n[0])=="string"){Z=n[0]}else{N=n[0]}if(n.length>=2){j=n[1]}}var i,U=j,V={},q={},H=C(this).eq(0);if(C.fn.metadata){q=H.metadata()}if(!Z){i=H.data(B);if(!i){i={};H.data(B,i)}C.extend(true,V,D,N,q[B]||q||{});i.options=V}else{i=H.data(B);if(i){V=i.options}else{return this}}var I,E,l,r,L,G,g;if(V.offsets){V.offset=V.offsets}if(N&&(N.animateOptions||N.animateParams)){V.animate=true}if(N&&(N.reaffixing)){V.animate=false}if(V.glueInsideWindow){V.keepInWindow=V.glueInsideWindow}V.element=V.element||V.el||V.e||V.target;V.window=V.window||V.win||V.w;V.offscreen=V.offscreen||V.os||V.o;if(!(V.element||V.window||V.offscreen)){throw ("No affix target specified")}G={width:C(window).width(),height:C(window).height()};L={top:C(window).scrollTop(),left:C(window).scrollLeft()};l={width:H.outerWidth(),height:H.outerHeight()};var P={derive:function(d){var a={from:V.from,to:V.to};var p=k(d||P.eqn,V.from);var o=O(p,a);var m=e(p,a);Y(H,V.from,V.classGlueFromPrefix);return{left:p.left,top:p.top,from:a.from,to:a.to,offset:o,insetOffset:m}},eqn:{n:"wx+h:ww-h:fw,wy",ne:"wx+ww-fw,wy",e:"wx+ww-fw,wy+h:wh-h:fh",se:"wx+ww-fw,wy+wh-fh",s:"wx+h:ww-h:fw,wy+wh-fh",sw:"wx,wy+wh-fh",w:"wx,wy+h:wh-h:fh",nw:"wx,wy",c:"wx+h:ww-h:fw,wy+h:wh-h:fh"}};var J={derive:function(){return P.derive(J.eqn)},eqn:{n:"wx+h:ww-h:fw,wy-fh",nne:"wx+ww-fw,wy-fh",ne:"wx+ww,wy-fh",ene:"wx+ww,wy",e:"wx+ww,wy+h:wh-h:fh",ese:"wx+ww,wy+wh-fh",se:"wx+ww,wy+wh",sse:"wx+ww-fw,wy+wh",s:"wx+h:ww-h:fw,wy+wh",ssw:"wx,wy+wh",sw:"wx-fw,wy+wh",wsw:"wx-fw,wy+wh-fh",w:"wx-fw,wy+h:wh-h:fh",wnw:"wx-fw,wy",nw:"wx-fw,wy-fh",nnw:"wx,wy-fh"}};J.eqn.c=J.eqn.n;J.eqn.nwv=J.eqn.vnw=J.eqn.nnw;J.eqn.nwh=J.eqn.hnw=J.eqn.wnw;J.eqn.nev=J.eqn.vne=J.eqn.nne;J.eqn.neh=J.eqn.hne=J.eqn.ene;J.eqn.sev=J.eqn.vse=J.eqn.sse;J.eqn.seh=J.eqn.hse=J.eqn.ese;J.eqn.swv=J.eqn.vsw=J.eqn.ssw;J.eqn.swh=J.eqn.hsw=J.eqn.wsw;var h={derive:function(){var m=S.css("visibility");if(V.use=="position"){I=S.position()}else{I=S.offset()}E={width:S.outerWidth(),height:S.outerHeight()};var d={to:V.to,from:V.from};var s=h.getPosition(d);var p=O(s,d);var o=e(s,d);if(V.keepInWindow){var a=h.glueInsideWindow(s,d);if(a){d=a;s=h.getPosition(d);p=O(s,d);o=e(s,d)}}Y(H,d.from,V.classGlueFromPrefix);Y(S,d.to,V.classGlueToPrefix);return{left:s.left,top:s.top,from:d.from,to:d.to,offset:p,insetOffset:o}},getPosition:function(a){return k(h.eqn,a.from+"_"+a.to,h.tokenValue)},glueInsideWindow:function(u,p){var m=p.to.search("n")!=-1;var a=p.to.search("s")!=-1;var t=p.to.search("e")!=-1;var w=p.to.search("w")!=-1;var v=u.top<L.top;var o=u.left<L.left;var d=u.left+l.width>L.left+G.width;var s=u.top+l.height>L.top+G.height;var x=[p.from,p.to];if(!v&&!s&&!d&&!o){return false}if((v&&m)||(s&&a)){x[0]=h.swapNS(x[0]);x[1]=h.swapNS(x[1])}if((d&&t)||(o&&w)){x[0]=h.swapEW(x[0]);x[1]=h.swapEW(x[1])}return{from:x[0],to:x[1]}},swapNS:function(a){return a.replace(/n/g,"T").replace(/s/g,"n").replace(/T/g,"s")},swapEW:function(a){return a.replace(/e/g,"T").replace(/w/g,"e").replace(/T/g,"w")},tokenValue:function(a){switch(a){case"tpw":case"tpe":case"tps":case"tpn":return b(h.eqnm[a.substr(2,1)],h.tokenValue);case"h:tw":case"h:th":return Math.round(h.tokenValue(a.substr(2,2))/2);case"tw":return E.width;case"th":return E.height;case"tpx":return I.left;case"tpy":return I.top;default:return W(a)}return false},eqn:{n_n:"tpx+h:tw-h:fw,tpn",n_ne:"tpe-h:fw,tpn",n_e:"tpe-h:fw,tpn+h:th",n_se:"tpe-h:fw,tps",n_s:"tpw+h:tw-h:fw,tps",n_sw:"tpw-h:fw,tps",n_w:"tpw-h:fw,tpn+h:th",n_nw:"tpw-h:fw,tpn",n_c:"tpw+h:tw-h:fw,tpn+h:th",ne_n:"tpx+h:tw-fw,tpn",ne_ne:"tpe-fw,tpn",ne_e:"tpe-fw,tpn+h:th",ne_se:"tpe-fw,tps",ne_sw:"tpw-fw,tps",ne_s:"tpw+h:tw-fw,tps",ne_w:"tpw-fw,tpn+h:th",ne_nw:"tpw-fw,tpn",ne_c:"tpw+h:tw-fw,tpn+h:th",e_n:"tpx+h:tw-fw,tpn-h:fh",e_ne:"tpe-fw,tpn-h:fh",e_e:"tpe-fw,tpn+h:th-h:fh",e_se:"tpe-fw,tps-h:fh",e_s:"tpw+h:tw-fw,tps-h:fh",e_sw:"tpw-fw,tps-h:fh",e_w:"tpw-fw,tpn+h:th-h:fh",e_nw:"tpw-fw,tpn-h:fh",e_c:"tpw+h:tw-fw,tpn+h:th-h:fh",se_n:"tpx+h:tw-fw,tpn-fh",se_ne:"tpe-fw,tpn-fh",se_e:"tpe-fw,tpn+h:th-fh",se_se:"tpe-fw,tps-fh",se_s:"tpw+h:tw-fw,tps-fh",se_sw:"tpw-fw,tps-fh",se_w:"tpw-fw,tpn+h:th-fh",se_nw:"tpw-fw,tpn-fh",se_c:"tpw+h:tw-fw,tpn+h:th-fh",s_n:"tpx+h:tw-h:fw,tpn-fh",s_ne:"tpe-h:fw,tpn-fh",s_e:"tpe-h:fw,tpn+h:th-fh",s_se:"tpe-h:fw,tps-fh",s_s:"tpw+h:tw-h:fw,tps-fh",s_sw:"tpw-h:fw,tps-fh",s_w:"tpw-h:fw,tpn+h:th-fh",s_nw:"tpw-h:fw,tpn-fh",s_c:"tpw+h:tw-h:fw,tpn+h:th-fh",sw_n:"tpx+h:tw,tpn-fh",sw_ne:"tpe,tpn-fh",sw_e:"tpe,tpn+h:th-fh",sw_se:"tpe,tps-fh",sw_s:"tpw+h:tw,tps-fh",sw_sw:"tpw,tps-fh",sw_w:"tpw,tpn+h:th-fh",sw_nw:"tpw,tpn-fh",sw_c:"tpw+h:tw,tpn+h:th-fh",w_n:"tpx+h:tw,tpn-h:fh",w_ne:"tpe,tpn-h:fh",w_e:"tpe,tpn+h:th-h:fh",w_se:"tpe,tps-h:fh",w_s:"tpw+h:tw,tps-h:fh",w_sw:"tpw,tps-h:fh",w_w:"tpw,tpn+h:th-h:fh",w_nw:"tpw,tpn-h:fh",w_c:"tpw+h:tw,tpn+h:th-h:fh",nw_n:"tpx+h:tw,tpn",nw_ne:"tpe,tpn",nw_e:"tpe,tpn+h:th",nw_se:"tpe,tps",nw_s:"tpw+h:tw,tps",nw_sw:"tpw,tps",nw_w:"tpw,tpn+h:th",nw_nw:"tpw,tpn",nw_c:"tpw+h:tw,tpn+h:th",c_n:"tpx+h:tw-h:fw,tpn-h:fh",c_ne:"tpe-h:fw,tpn-h:fh",c_e:"tpe-h:fw,tpn+h:th-h:fh",c_se:"tpe-h:fw,tps-h:fh",c_s:"tpw+h:tw-h:fw,tps-h:fh",c_sw:"tpw-h:fw,tps-h:fh",c_w:"tpw-h:fw,tpn+h:th-h:fh",c_nw:"tpw-h:fw,tpn-h:fh",c_c:"tpw+h:tw-h:fw,tpn+h:th-h:fh"},eqnm:{n:"tpy",ne:"",e:"tpx+tw",s:"tpy+th",w:"tpx"}};var k=function(o,a,d){var m=o[a].split(",");return{left:Math.round(b(m[0],d||W)),top:Math.round(b(m[1],d||W))}};var Y=function(d,m,a){d.attr("class",d.attr("class").replace(new RegExp("s?"+a+"[newsvhc]{1,3}s?","gi"),""));d.addClass(a+m)};var W=function(a){switch(a){case"h:fw":case"h:fh":case"h:wh":case"h:ww":return Math.round(W(a.substr(2,2))/2);case"ww":return G.width;case"wh":return G.height;case"wx":return(V.fixed&&!A)?0:L.left;case"wy":return(V.fixed&&!A)?0:L.top;case"fw":return l.width;case"fh":return l.height}return false};var M=function(a){var d;if(!V.offset.length&&V.offset[a.from+"_"+a.to]){d=V.offset[a.from+"_"+a.to]}else{if(V.offset.length&&V.offset.length==2){d=V.offset}else{if(V.offset[a.from]){d=V.offset[a.from]}else{if(V.offset["*"]){d=V.offset["*"]}}}}return d};var O=function(p,d){if(V.offset){var m=M(d)||[0,0];var a=parseInt(m[0],0);var o=parseInt(m[1],0);if(!isNaN(a)){p.left+=a}if(!isNaN(o)){p.top+=o}}return m};var e=function(m,a){var d=Q(m,a);m.left+=d[0];m.top+=d[1];return d};var Q=function(s,m){var d=V.inset;if(d){if(typeof (d)=="number"){d=[d,d]}var a={c:"0,0",n:"0,y",nne:"-x,y",ne:"-x,y",ene:"-x,y",e:"-x,0",ese:"-x,-y",se:"-x,-y",sse:"-x,-y",s:"0,-y",ssw:"x,-y",sw:"x,-y",wsw:"x,-y",w:"x,0",wnw:"x,y",nw:"x,y",nnw:"x,y"};if(V.smartOffscreenInset){a.nne="-x,0";a.ene="0,y";a.ese="0,-y";a.sse="-x,0";a.ssw="x,0";a.wsw="0,-y";a.wnw="0,y";a.nnw="x,0"}a.nwv=a.vnw=a.nnw;a.nwh=a.hnw=a.wnw;a.nev=a.vne=a.nne;a.neh=a.hne=a.ene;a.sev=a.vse=a.sse;a.seh=a.hse=a.ese;a.swv=a.vsw=a.ssw;a.swh=a.hsw=a.wsw;var o=(a[m.to]||a.c).split(",");return[R(o[0],d),R(o[1],d)]}return[0,0]};var R=function(d,o){var a=d.match(/([\-]?)([xy0])/);if(a){if(a[2]=="x"){if(a[1]=="-"){return -o[0]}else{return o[0]}}else{if(a[2]=="y"){if(a[1]=="-"){return -o[1]}else{return o[1]}}}}return 0};var b=function(o,s){var a=o.match(/([a-z:]+)|([\+\-])/g);var p=0;var u;for(var t=0;t<a.length;t++){u=(s||W)(a[t]);if(u!==false){if(t==0){p+=u}else{if(t%2==0){if(a[t-1]=="+"){p+=u}else{p-=u}}}}}return p};if(V.window||V.offscreen){var F=V.window||V.offscreen;var X=F.match(/^(?:([nweschv]*))?(?:(\+|-)([0-9]+))?(?:,([0-9]+))?/);if(X){if(X[1]){V.from=V.to=X[1]}if(X[2]&&X[3]){var c=parseInt(X[2],0);var K=X[3]?parseInt(X[3],0):0;if(X[2]=="-"){V.inset=[-K,-K];if(X[4]){V.inset[1]=-m4v}}else{V.inset=[K,K];if(X[4]){V.inset[1]=m4v}}}if(V.from&&(!V.to||V.to=="")){V.to=V.from}else{if(V.to&&(!V.from||V.from=="")){V.from=V.to}}if(V.window){g=P.derive();g.target="window"}else{if(V.offscreen){g=J.derive();g.target="offscreen"}}}}else{var S=C(V.element).eq(0);if(S.length==0){throw ("affix target element does not exist")}if(S){if(!V.to){var T={sw:"ne",w:"e",nw:"se",n:"s",ne:"sw",e:"w",se:"nw",s:"n",c:"c"};V.to=T[V.from]||"c"}if(!V.from){var f={ne:"sw",e:"w",se:"nw",s:"n",sw:"ne",w:"e",nw:"se",n:"s",c:"c"};V.from=f[V.to]||"c"}g=h.derive();g.target="element";g.t=S}}return g};C.fn.affix=function(){var G,F={},H={},E=arguments;if(E.length>=1){if(typeof (E[0])=="string"){G=E[0]}else{F=E[0]}if(E.length>=2){H=E[1]}}return this.each(function(){var P,M=H,O={},J={},I=C(this);if(C.fn.metadata){J=I.metadata()}if(!G){P=I.data("affix");if(!P){P={};I.data("affix",P)}C.extend(true,O,D,F,J.affix||J||{});P.options=O}else{P=I.data("affix");if(P){O=P.options}else{return }}if(!G){var L=I.affixPosition.apply(this,E);P.fReaffix=function(Q){if(I&&I.is(":visible")){I.affix("again")}};if(L.target=="window"||L.target=="offscreen"){if(O.fixed&&!A){var K=I.css("position");if(K!="fixed"){I.css("position","fixed")}}if(!P.windowOnResize){if(O.autoEvents&&O.autoEvents.resize){P.windowOnResize=P.fReaffix;C(window).resize(P.windowOnResize)}}if(!P.windowOnScroll){if(O.autoEvents&&O.autoEvents.scroll&&(A||!O.fixed)){P.windowOnScroll=P.fReaffix;C(window).scroll(P.windowOnScroll)}}}var N=function(){if(O.layerfix&&I.layerfix){I.layerfix(O.layerfix)}if(O.animateOptions.complete){O.animateOptions.complete()}};if(O.animate){I.animate(C.extend(true,{},O.animateParams||{},{left:L.left,top:L.top}),C.extend(true,{},O.animateOptions,{complete:N}))}else{I.css({left:L.left,top:L.top});N()}}else{if(G=="unaffix"){if(O.layerfix&&I.layerfix){I.layerfix("destroy")}I.affix("destroy")}else{if(G=="again"||G=="reaffix"){if(O.element||O.window||O.offscreen){I.affix(C.extend(true,{},O,{reaffixing:true}))}}else{if(G=="destroy"){if(P.windowOnResize){C(window).unbind("resize",P.windowOnResize);P.windowOnResize=null}if(P.windowOnScroll){C(window).unbind("scroll",P.windowOnScroll);P.windowOnScroll=null}if(P.ifs){P.ifs.remove()}P.options=null;I.removeData("affix")}}}}})};C.fn.unaffix=function(){return this.affix("unaffix")};C.fn.affixAnimate=C.fn.affixa=function(E){return this.affix(C.extend(true,{},E,{animate:true}))};C.fn.affixAnimateNQ=C.fn.affixanq=function(E){return this.affix(C.extend(true,{},E,{animateOptions:{queue:false}}))};C.fn.affixAnimateFadeIn=C.fn.affixafi=function(F,E){var G=F||{};return this.css({opacity:0}).show().affix(C.extend(true,{},F,{animate:true,animateParams:{opacity:E||1}}))};C.fn.affixAnimateFadeOut=C.fn.affixafo=function(F,E){return this.css({opacity:E||1}).affix(C.extend(true,{},F,{animateParams:{opacity:"hide"},animate:true,animateOptions:{complete:function(){C(this).hide()}}}))};C.fn.affix.defaults=D})(jQuery);